#!/usr/bin/env bash

MAX_ITERATIONS=20

vim PROMPT.md

case "${1:-}" in
    "claude")
        set -- claude -p --output-format=stream-json --verbose --dangerously-skip-permissions
        ;;
esac

iteration=0
while [ $iteration -lt $MAX_ITERATIONS ]; do
    iteration=$((iteration + 1))
    echo "Iteration $iteration/$MAX_ITERATIONS"
    "$@" < PROMPT.md | tee -a output.jsonl
    sleep 10
done

echo "Reached maximum iterations ($MAX_ITERATIONS)"
